<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>图片链接转base64</title>

    <script src="https://code.jquery.com/jquery-3.1.1.min.js"></script>
</head>
<body>

图片地址：<label for="userName"></label><input type="text" id="userName" onchange="tes(this.value)" style="width: 80%;height: 25px"/>
<br>
<br>
<br>
<br>
转换结果：
<br>
<br>
<label for="result"></label><textarea id="result" style="width: 80%;height: 200px"></textarea>

</body>

<script>
    function tes(url) {
        getUrlBase64(url, function (base64) {
            document.getElementById("result").value = base64;
        });
    }

    function getUrlBase64(url, callback) {
        let canvas = document.createElement("canvas");   //创建canvas DOM元素
        const ctx = canvas.getContext("2d");
        const img = new Image;
        img.crossOrigin = 'Anonymous';
        img.src = url;
        img.onload = function () {
            canvas.height = img.height; //指定画板的高度,自定义
            canvas.width = img.width; //指定画板的宽度，自定义
            ctx.drawImage(img, 0, 0, img.width, img.height); //参数可自定义

            const dataURL = canvas.toDataURL("image/png");
            callback.call(this, dataURL); //回掉函数获取Base64编码
            canvas = null;
        };
    }

</script>

</html>
